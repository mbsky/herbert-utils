//手动配置导出文件路径
var exportSWFPath = "file:///d|/tomcat60/webapps/flashdir/res/data/sound/sound.swf";
//手动添加的导出类名和文件名
var fileInfos = [
	#foreach($entry in $list)
	["sound_$!{entry.id}","file:///D|/tomcat60/webapps/resRoot/$!{entry.name}"],
#end
];

//配置参数
var width = 1;
var height = 1;
var frameRate = 24;
var compressionType = "MP3";//压缩方式( 可以为"Default","ADPCM","MP3","Raw","Speech", 在soundItem.useImportedMP3Quality =false的情况下起作用)
var soundQuality = "Fast";//品质（可以为 "Fast","Medium","Best", 仅在compressionType="MP3"的情况下起作用）
var bits = 16;//比特率(在soundItem.useImportedMP3Quality =false的情况下起作用)

//定义变量
var fileInfo, className, filePath, fileName;
var dom, lib, tl;
var soundItem;

//创建新文档
fl.createDocument();
dom = fl.getDocumentDOM();
dom.setPlayerVersion("9");
dom.asVersion=3;
dom.frameRate = frameRate;
dom.width = width;
dom.height = height;
lib=dom.library;
tl=dom.getTimeline();
//在第一帧加入一句安全策略脚本
tl.layers[0].frames[0].actionScript = 'import flash.system.Security;try{Security.allowDomain("*");}catch(e:Error){}';


//添加进库
if(fileInfos.length>0)
{
	//生成动画并发布
	for each(fileInfo in fileInfos)
	{
		className = fileInfo[0];
		filePath = fileInfo[1];
		fileName = filePath.replace(/^(.*\/)*([^\/]+\..+)$/,"$2");
		//如果指定文件存在
		if (FLfile.exists(filePath)) 
		{
			//添加进库，但不舞台上创建实例
			dom.importFile(filePath,true);	

			//设置属性
			lib.selectItem(fileName); 
			//防止重名，重命名
			lib.renameItem(className+filePath.replace(/^(.*\/)*[^\/]+(\..+)$/,"$2"))
			soundItem = lib.getSelectedItems()[0];
			soundItem.allowSmoothing = true; //允许平滑

			if(compressionType=="MP3")
			{
				soundItem.compressionType = "MP3";
				soundItem.quality = soundQuality;
			}

			soundItem.linkageExportForAS = true;
			soundItem.linkageExportInFirstFrame = true;
			soundItem.linkageIdentifier = className;
			soundItem.linkageBaseClass = "flash.media.Sound";
		}
	}
}

//发布
dom.exportSWF(exportSWFPath, true);
//关闭该文档
fl.closeDocument(dom, false);


//关闭所有打开的文件
fl.closeAll(false);
//退出flash
fl.quit(false);
