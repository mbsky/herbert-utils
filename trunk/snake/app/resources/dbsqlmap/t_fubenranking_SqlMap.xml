<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="t_fubenranking">
	<typeAlias alias="Fubenranking" type="net.snake.gamemodel.instance.bean.Fubenranking" />
	<resultMap class="Fubenranking" id="FubenrankingRes">
		<result column="f_id" jdbcType="INTEGER" property="id" />
		<result column="f_character_id" jdbcType="INTEGER" property="characterId" />
		<result column="f_character_grade" jdbcType="INTEGER" property="characterGrade" />
		<result column="f_fuben_id" jdbcType="INTEGER" property="fubenId" />
		<result column="f_fuben_time" jdbcType="INTEGER" property="fubenTime" />
		<result column="f_fuben_date" jdbcType="TIME" property="fubenDate" />
		<result column="f_previous_time" jdbcType="INTEGER" property="previousTime" />
	</resultMap>

	<select id="getFubenRanking" parameterClass="java.lang.Integer" resultMap="FubenrankingRes">
		select * from t_fubenranking where f_fuben_id=#fu_ben_id# order by f_fuben_time ,f_character_id
		LIMIT 0, 100
	</select>

	<select id="selecteFubenListByCharacterId" parameterClass="java.lang.Integer" resultMap="FubenrankingRes">
		select * from t_fubenranking where f_character_id=#characterId#
	</select>

	<select id="getFuBendistinct" resultClass="java.lang.Integer">
		select distinct f_fuben_id as fubenId from t_fubenranking
	</select>
	<select id="getFuBendistinctTongJi" parameterClass="java.lang.Integer" resultClass="Fubenranking">
		SELECT
		t_fubenranking.f_id as id,
		t_fubenranking.f_character_id as characterId,
		t_fubenranking.f_fuben_id as fubenId ,
		t_fubenranking.f_fuben_time as fubenTime,
		t_character.f_grade as characterGrade
		FROM
		t_fubenranking
		INNER JOIN t_character ON
		t_fubenranking.f_character_id = t_character.f_id
		WHERE
		t_character.f_grade = #grade#
		ORDER BY
		f_fuben_id desc,
		f_fuben_time ,
		f_character_id ASC
		LIMIT 0,100;
	</select>

	<insert id="insert" parameterClass="Fubenranking">
		insert into t_fubenranking (f_id, f_character_id, f_character_grade,
		f_fuben_id, f_fuben_time,
		f_fuben_date, f_previous_time)
		values
		(#id:INTEGER#, #characterId:INTEGER#, #characterGrade:INTEGER#,
		#fubenId:INTEGER#,
		#fubenTime:INTEGER#, #fubenDate:TIME#, #previousTime:INTEGER#)
	</insert>

	<update id="updateByTime" parameterClass="Fubenranking">
		update t_fubenranking set f_fuben_time = #fubenTime:INTEGER#, f_previous_time = #previousTime:INTEGER# where f_id = #id:INTEGER#
	</update>

</sqlMap>